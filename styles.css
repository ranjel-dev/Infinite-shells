:root{
  --shellSize: clamp(78px, 11vw, 120px);
  --pearlSize: clamp(44px, 6vw, 64px);

  /* Lifelines */
  --lifeSize: clamp(64px, 9vw, 88px);

  /* Shell hitbox (WIDER now) */
  --hitW: calc(var(--shellSize) * 1.55);
  --hitH: calc(var(--shellSize) * 1.55);

  /* Neutral pip color that pops across themes */
  --pipOn: #ffd54a;
  --pipOff: rgba(255,255,255,0.12);
}

*{ box-sizing:border-box; }

body{
  margin:0;
  padding:14px;
  background:#0b0b10;
  color:#e8e8ef;
  font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

#hud{
  max-width:920px;
  margin:0 auto 12px;
  display:grid;
  gap:8px;
}

#scoreLine{ font-size:18px; }
#msg{ min-height:1.2em; opacity:.92; }

#btnReset{
  padding:10px 14px;
  border-radius:10px;
  border:1px solid #2c2c3a;
  background:#151522;
  color:#e8e8ef;
  cursor:pointer;
}

/* =========================
   GAME BOARD
========================= */
#board{
  width:min(920px, calc(100vw - 28px));
  aspect-ratio:16/9;
  margin:0 auto;
  border-radius:22px;
  border:1px solid #2c2c3a;
  position:relative;
  overflow:hidden;

  background:#0F2F1F;

  user-select:none;
  cursor:pointer;
}

/* Rotate warning */
#rotateOverlay{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background:#0b0b10;
  color:#e8e8ef;
  letter-spacing:.08em;
  z-index:2000;
}
@media (orientation:portrait){
  #rotateOverlay{ display:flex; }
}

/* =========================
   SCREENS
========================= */
.screen{
  position:absolute;
  inset:0;
  display:none;
  z-index:1200;
}
.screenBg{ position:absolute; inset:0; }
.screenContent{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  transition:opacity 550ms ease;
}
.screen.show{ display:block; }
.screen.show .screenContent{ opacity:1; }
.screen.fadeOut .screenContent{ opacity:0; }

/* LOADING */
#loadingScreen{ z-index:1300; }
#loadingScreen .screenBg{ background:#ffffff; }

#loadingLogo{
  max-width:82%;
  max-height:64%;
  object-fit:contain;
  pointer-events:none;
  user-select:none;
}

/* TITLE */
#titleScreen{ z-index:1250; }
#titleScreen .screenBg{ background:#0b0b10; }

#titleImage{
  width:100%;
  height:100%;
  object-fit:cover;
  pointer-events:none;
  user-select:none;
}

.pressStart{
  position:absolute;
  bottom:18%;
  left:50%;
  transform:translateX(-50%);
  font-size:clamp(14px, 3vw, 22px);
  letter-spacing:0.22em;
  text-transform:uppercase;
  color:#e8e8ef;
  opacity:.5;
  animation:ctaFade 2s ease-in-out infinite;
  pointer-events:none;
}
@keyframes ctaFade{
  0%{opacity:.35}
  50%{opacity:.85}
  100%{opacity:.35}
}

/* =========================
   MAIN MENU
========================= */
#menuScreen{ z-index:1240; }
#menuScreen .screenBg{
  background: radial-gradient(1200px 600px at 50% 25%, rgba(255,255,255,0.06), rgba(0,0,0,0.55));
}

.menuWrap{
  width:min(520px, 86%);
  border-radius:20px;
  border:1px solid rgba(255,255,255,0.10);
  background:rgba(10,12,16,0.75);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  padding:22px 18px 18px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.45);
  text-align:center;
}

.menuTitle{
  font-weight:900;
  letter-spacing:0.22em;
  font-size:clamp(18px, 3vw, 26px);
  margin-bottom:16px;
  opacity:0.95;
}

.menuButtons{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.menuBtn{
  width:100%;
  padding:14px 14px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.06);
  color:#e8e8ef;
  cursor:pointer;
  font-weight:700;
  letter-spacing:0.04em;
}

.menuBtn.primary{
  background:rgba(255,213,74,0.12);
  border-color:rgba(255,213,74,0.25);
}

.menuBtn.disabled{
  opacity:0.45;
  cursor:default;
}

.menuNote{
  margin-top:12px;
  opacity:0.72;
  font-size:13px;
}

/* =========================
   LIFELINES (TOP RIGHT)
========================= */
#lifelines{
  position:absolute;
  top:18px;
  right:18px;
  display:flex;
  gap:14px;
  z-index:900;
}

.life{
  flex:0 0 var(--lifeSize);
  width:var(--lifeSize);
  height:var(--lifeSize);

  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background:rgba(8,12,14,0.55);

  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.04),
    0 10px 18px rgba(0,0,0,0.25);

  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);

  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;

  padding:10px;
  gap:10px;

  margin:0;
  font:inherit;
  line-height:1;
  -webkit-appearance:none;
  appearance:none;

  cursor:pointer;
}

.life.static{ cursor:default; }
.life.locked{ opacity:0.45; filter:saturate(0.85); }
.life.disabled{ opacity:0.55; cursor:default; }
.life:active{ transform:scale(0.985); }

.life .ico{
  width:52%;
  height:52%;
  display:flex;
  align-items:center;
  justify-content:center;
}

.life svg{
  width:100%;
  height:100%;
  fill:none;
  stroke:rgba(255,255,255,0.85);
  stroke-width:2;
  stroke-linecap:round;
  stroke-linejoin:round;
}

.life.locked svg{ stroke:rgba(255,255,255,0.35); }

.pips{ display:flex; gap:8px; align-items:center; justify-content:center; }
.pip{
  width:10px;
  height:10px;
  border-radius:999px;
  background:var(--pipOff);
  box-shadow: 0 0 0 1px rgba(0,0,0,0.22) inset;
}
.pip.on{
  background:var(--pipOn);
  box-shadow:
    0 0 0 1px rgba(0,0,0,0.18) inset,
    0 0 10px rgba(255,213,74,0.22);
}

/* =========================
   GAME ELEMENTS
========================= */
#shellLayer{
  position:absolute;
  inset:0;
  z-index:10;
}

/* wrapper holds BOTH hitbox and visual */
.shellWrap{
  position:absolute;
  bottom:34%;
  transform:translateX(-50%);
  width:var(--hitW);
  height:var(--hitH);
  display:flex;
  align-items:center;
  justify-content:center;
  transition:left 260ms ease, transform 260ms ease, opacity 160ms ease;
  filter: drop-shadow(0 10px 12px rgba(0,0,0,.35));
}

/* big press target */
.shellHit{
  position:absolute;
  inset:0;
  border-radius:20px;
  background:transparent;
  pointer-events:auto;
}

/* actual shell art */
.shell{
  width:var(--shellSize);
  height:var(--shellSize);
  border-radius:18px;
  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;
  pointer-events:none; /* hitbox handles presses */
}

.shellWrap.lift{
  transform:translateX(-50%) translateY(-22px) scale(1.03);
}

.shellWrap.dim{ opacity:0.25; }
.shellWrap.hint{ opacity:1; }

/* =========================
   PEARL (TUCKED UNDER SHELL)
========================= */
#pearl{
  position:absolute;
  width:var(--pearlSize);
  height:var(--pearlSize);

  /* IMPORTANT: tuck it INTO the shell area so it looks "under" it */
  bottom:calc(34% + (var(--shellSize) * 0.12));

  transform:translateX(-50%);
  opacity:0;
  transition:opacity 140ms ease;

  /* IMPORTANT: behind the shells */
  z-index:9;

  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;

  filter:
    drop-shadow(0 0 10px rgba(180,255,220,0.20))
    drop-shadow(0 0 22px rgba( 90,255,190,0.12));
}

/* =========================
   OVERLAY / RECORD
========================= */
#overlay{
  position:absolute;
  inset:0;
  background:rgba(255,40,60,.22);
  opacity:0;
  transition:opacity 160ms ease;
  pointer-events:none;
  z-index:50;
}
#overlay.flash{ opacity:1; }

#recordText{
  position:absolute;
  top:18px;
  left:50%;
  transform:translateX(-50%);
  font-weight:800;
  letter-spacing:1px;
  color:#ffd54a;
  opacity:0;
  transition:opacity 250ms ease;
  z-index:60;
}
#recordText.show{ opacity:1; }

/* =========================
   RETRY MODAL
========================= */
#retryModal{
  position:absolute;
  inset:0;
  display:none;
  z-index:1500;
}
#retryModal.show{ display:block; }

#retryModal .backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.55);
}

#retryModal .panel{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%, -50%);
  width:min(420px, 86%);
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(12,14,20,0.92);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 18px 40px rgba(0,0,0,0.45);
  padding:18px 18px 16px;
}

#retryModal .title{
  font-weight:800;
  font-size:18px;
  letter-spacing:0.02em;
  margin-bottom:6px;
}

#retryModal .desc{
  opacity:0.85;
  line-height:1.35;
  margin-bottom:14px;
}

#retryModal .actions{
  display:flex;
  gap:10px;
  justify-content:flex-end;
}

.modalBtn{
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.06);
  color:#e8e8ef;
  cursor:pointer;
}

.modalBtn.primary{
  background:rgba(255,213,74,0.14);
  border-color:rgba(255,213,74,0.28);
}